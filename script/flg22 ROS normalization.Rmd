---
title: "flg22 normalized ROS"
output: html_document
date: "2023-01-27"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots
```{R}
library(reshape2)
library(ggplot2)
library(dplyr)
```

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
library(ggplot2)
library(reshape2)
library(dplyr)

# Read the CSV file
pc <- read.csv("../input/WTNb_XL_Tj_Qv.csv")

# Melt the data frame
pcm <- melt(pc, id = c("Receptor"))

# Ensure Receptor is a factor with the correct levels
pcm$Receptor <- factor(pcm$Receptor, levels = c("NbFLS2", "FLS2XL", "TjFLS2", "QvFLS2"))

# Create a new column 'Color' with the default colors based on 'Receptor'
pcm$Color <- case_when(
  pcm$Receptor == "FLS2XL" & pcm$value >= 10 ~ "#33658A",
  pcm$Receptor == "QvFLS2" & pcm$value >= 10 ~ "#F26157",
  pcm$Receptor == "TjFLS2" & pcm$value >= 10 ~ "#679289",
  pcm$Receptor == "NbFLS2" & pcm$value >= 10 ~ "#3a3b3c",
  pcm$value < 10 ~ "lightgray", # Apply light gray color when value is less than 10
  TRUE ~ NA_character_ # For unexpected cases
)

# Proceed with the ggplot
xx <- ggplot(pcm, aes(x = Receptor, y = variable)) + 
  geom_point(aes(size = value, fill = Color), alpha = 0.75, shape = 21) + 
  scale_size_continuous(limits = c(0, 160), range = c(1, 16), breaks = c(25, 50, 75, 100, 160)) + 
  labs(x = "", y = "", size = "Normalized ROS (%)", fill = "") + 
  theme(legend.key = element_blank(), 
        axis.text.x = element_text(angle = 45, hjust = 1, colour = "black", size = 14, face = "bold", vjust = 1), 
        axis.text.y = element_text(colour = "black", face = "bold", size = 13), 
        legend.text = element_text(size = 10, face ="bold", colour ="black"), 
        legend.title = element_text(size = 12, face = "bold"), 
        legend.position = "right") + 
  scale_fill_identity(guide = FALSE) +  # Use colors directly from the Color column
  scale_y_discrete(limits = rev(levels(pcm$variable)))

print(xx)

# Save the plot
ggsave(filename = "../output/Figure_1_All_FLS2_bubble.pdf", width = 5.6, height = 6.5)


```


Grey bubble for Vr-XLFLS2 group
```{r}
pc = read.csv("../input/Vr-XL.csv", header = TRUE)
pcm = melt(pc, id = c("Receptor"))
pcm$Receptor <- factor(pcm$Receptor,levels=unique(pcm$Receptor))

# Ensure Receptor is a factor with the correct levels
#pcm$Receptor <- factor(pcm$Receptor, levels = c("NbFLS2", "FLS2XL", "TjFLS2", "QvFLS2"))

# Create a new column 'Color' with the default colors based on 'Receptor'
pcm$Color <- case_when(
  pcm$Receptor == "FLS2XL" & pcm$value >= 10 ~ "#6B6ACF",
  pcm$Receptor == "VrFLS2" & pcm$value >= 10 ~ "#c7c5d3",
  pcm$Receptor == "SynVrFLS2 V1" & pcm$value >= 10 ~ "#7b78cf",
  pcm$Receptor == "SynVrFLS2 V4" & pcm$value >= 10 ~ "#a19bd2",
  pcm$Receptor == "SynVrFLS2 V2" & pcm$value >= 10 ~ "#b4b0d3",
  pcm$value < 10 ~ "lightgray", # Apply light gray color when value is less than 10
  TRUE ~ NA_character_ # For unexpected cases
)
xx <- ggplot(pcm, aes(y = Receptor, x = variable)) + 
  geom_point(aes(size = value, fill = Color), alpha = 0.85, shape = 21) + 
  scale_size_continuous(limits = c(0, 160), range = c(1, 14), breaks = c(25, 50, 75, 140)) + 
  labs(y = "", x = "", size = "Normalized ROS (%)", fill = "")  + 
  theme_classic() +
  theme(
    legend.key = element_blank(), 
    axis.text.y = element_text(colour = "black", size = 14, face = "bold"), 
    axis.text.x = element_text(angle = 45, hjust = 1, colour = "black", size = 14, face = "bold", vjust = 1), 
    legend.text = element_text(size = 10, face = "bold", colour = "black"), 
    legend.title = element_text(size = 12, face = "bold"), 
    legend.position = "right",
    panel.grid.major = element_line(colour = "lightgrey", linewidth = 0.5),
    panel.grid.minor = element_blank()
  ) +
  scale_fill_identity(guide = FALSE) +  # Use colors directly from the Color column
  scale_y_discrete(limits = rev(levels(pcm$Receptor))) 
print(xx)
ggsave(filename = "../output/Vr-XL.pdf", width = 7, height = 3.4)

```

Grey bubble for Qv-FcFLS2 group
```{r}
pc = read.csv("../input/Fc-Qv.csv", header = TRUE)
pcm = melt(pc, id = c("Receptor"))
pcm$Receptor <- factor(pcm$Receptor,levels=unique(pcm$Receptor))

xx <- ggplot(pcm, aes(y = Receptor, x = variable)) + 
  geom_point(aes(size = value), alpha = 0.85, shape = 21, fill = "#555555", color = "black") + 
  scale_size_continuous(limits = c(0, 180), range = c(1, 14), breaks = c(25, 50, 75, 170)) + 
  labs(y = "", x = "", size = "Normalized ROS (%)", fill = "")  + 
  theme_classic() +
  theme(
    legend.key = element_blank(), 
    axis.text.y = element_text(colour = "black", size = 14, face = "bold"), 
    axis.text.x = element_text(angle = 45, hjust = 1, colour = "black", size = 14, face = "bold", vjust = 1), 
    legend.text = element_text(size = 10, face = "bold", colour = "black"), 
    legend.title = element_text(size = 12, face = "bold"), 
    legend.position = "right",
    panel.grid.major = element_line(colour = "lightgrey", linewidth = 0.5),
    panel.grid.minor = element_blank()
  ) +
  scale_y_discrete(limits = rev(levels(pcm$Receptor))) 
print(xx)
ggsave(filename = "../output/Qv-Fc.pdf", width = 7, height = 3.4)

```